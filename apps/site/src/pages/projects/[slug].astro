---
import { marked } from 'marked';

import Layout from '@layouts/PageLayout.astro';
import {Hero} from '@widgets/Project/Project.astro';

import { getAllProjects } from '@lib/collections/projectHelpers';
import {getImageMetadataByPath} from '@lib/getImageMetadataByPath';

export async function getStaticPaths() {
    const processedProjects = await getAllProjects();

    return processedProjects.map((project) => ({
        params: { slug: project.slug },
        props: { project },
    }));
}

const { project } = Astro.props;

const content = project.content;
const html =await marked.parse(content);

const heroImageMetadata = getImageMetadataByPath(project.hero.src);
---

<Layout meta={{ title: project.title }}>
    {heroImageMetadata && (
        <Hero
            mobileImagePath={heroImageMetadata}
            desktopImagePath={heroImageMetadata}
        />
    )}
    <div class='relative flex flex-col bg-surface-dim z-10  overflow-x-hidden'>

        <section class='flex flex-col w-full md:sticky top-0 py-24'>
            <div class='sw-container flex flex-col space-y-10 z-10 text-on-surface'>
            <h1>{project.title}</h1>
            <h5 class=''>{project.subtitle}</h5>
        </div>
        </section>

        <section class='relative flex flex-col w-full pb-12 z-20 bg-surface-bright'></section>

    </div>
</Layout>
